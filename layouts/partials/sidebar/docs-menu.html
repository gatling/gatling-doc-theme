{{ $currentPage := . -}}

<!-- Menu name is directory path, without slashes, and reference is remove in favor of a dash (e.g: oss-3.3) -->
{{ $menu := .Parent.File.Dir }}
{{ $menu = replace $menu "reference/" "" }}
{{ $menu = trim $menu "/" }}
{{ $menu = replace $menu "/" "-"}}

{{ $menu }}
{{ range (index .Site.Menus $menu ) -}}
<h3>{{ .Name }}</h3>
{{ if .HasChildren -}}
<ul class="list-unstyled">
  {{ range .Children -}}
  {{- $active := or ($currentPage.IsMenuCurrent $menu .) ($currentPage.HasMenuCurrent $menu .) -}}
  {{- $active = or $active (eq $currentPage.Section .Identifier) -}}
  <li><a class="docs-link{{ if $active }} active{{ end }}" href="{{ .URL | absURL }}">{{ .Name }}</a></li>
  {{ end -}}
</ul>
{{ end -}}
{{ end -}}
